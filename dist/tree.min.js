!function(e,t){"object"===typeof exports&&"object"===typeof module?module.exports=t():"function"===typeof define&&define.amd?define([],t):"object"===typeof exports?exports.Tree=t():e.Tree=t()}(window,function(){return function(e){var t={};function s(n){if(t[n])return t[n].exports;var i=t[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,s),i.l=!0,i.exports}return s.m=e,s.c=t,s.d=function(e,t,n){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},s.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(s.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)s.d(n,i,function(t){return e[t]}.bind(null,i));return n},s.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="",s(s.s=0)}([function(e,t,s){"use strict";function n(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var s=[],n=!0,i=!1,a=void 0;try{for(var r,o=e[Symbol.iterator]();!(n=(r=o.next()).done)&&(s.push(r.value),!t||s.length!==t);n=!0);}catch(e){i=!0,a=e}finally{try{n||null==o.return||o.return()}finally{if(i)throw a}}return s}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function i(e){var t={};return e.reduce(function(e,s){return t[s]||(t[s]=!0,e.push(s)),e},[])}function a(e,t){requestAnimationFrame(function(){t.enter(),requestAnimationFrame(function(){t.active(),setTimeout(function(){t.leave()},e)})})}function r(e,t){this.treeNodes=[],this.nodesById={},this.leafNodesById={},this.liElementsById={},this.willUpdateNodesById={},this.container=e,this.options=Object.assign({selectMode:"checkbox",values:[],disables:[],closeDepth:null},t),this.myValues=[],Object.defineProperties(this,{values:{get:function(){return this.getValues()},set:function(e){return this.setValues(i(e))}},disables:{get:function(){return this.getDisables()},set:function(e){return this.setDisables(i(e))}},selectedNodes:{get:function(){var e=[],t=this.nodesById;for(var s in t)if(t.hasOwnProperty(s)&&(1===t[s].status||2===t[s].status)){var n=Object.assign({},t[s]);delete n.parent,delete n.children,e.push(n)}return e}},disabledNodes:{get:function(){var e=[],t=this.nodesById;for(var s in t)if(t.hasOwnProperty(s)&&t[s].disabled){var n=Object.assign({},t[s]);delete n.parent,e.push(n)}return e}}}),this.init(this.options.data)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=r,r.prototype.init=function(e){var t=r.parseTreeData(e),s=t.treeNodes,n=t.nodesById,i=t.leafNodesById,a=t.defaultValues,o=t.defaultDisables;this.treeNodes=s,this.nodesById=n,this.leafNodesById=i,this.render(this.treeNodes);var d=this.options,l=d.values,c=d.disables;l&&l.length&&(a=l),a.length&&this.setValues(a),c&&c.length&&(o=c),o.length&&this.setDisables(o)},r.prototype.render=function(e){var t=r.createRootEle();t.appendChild(this.buildTree(e,0)),this.bindEvent(t);var s=document.querySelector(this.container);!function(e){for(;e.firstChild;)e.removeChild(e.firstChild)}(s),s.appendChild(t)},r.prototype.buildTree=function(e,t){var s=this,n=r.createUlEle();return e&&e.length&&e.forEach(function(e){var i=r.createLiEle(e,!e.open);s.liElementsById[e.id]=i;var a=null;e.children&&e.children.length&&(a=s.buildTree(e.children,t+1)),a&&i.appendChild(a),n.appendChild(i)}),n},r.prototype.bindEvent=function(e){var t=this;e.addEventListener("click",function(e){var s=e.target;"SPAN"===s.nodeName&&(s.classList.contains("treejs-checkbox")||s.classList.contains("treejs-label"))?t.onItemClick(s.parentNode.nodeId):"LI"===s.nodeName&&s.classList.contains("treejs-node")?t.onItemClick(s.nodeId):"SPAN"===s.nodeName&&s.classList.contains("treejs-switcher")&&t.onSwitcherClick(s)},!1)},r.prototype.onItemClick=function(e){var t=this.nodesById[e],s=this.options.onChange;t.disabled||(this.setValue(e),this.updateLiElements()),s&&s.call(this,{name:t.name,id:t.id,checked:2===t.status})},r.prototype.setValue=function(e){var t=this.nodesById[e];if(t){var s,n=t.status,i=1===n||2===n?0:2;t.status=i,0!==t.status?this.myValues.push({name:t.name,id:t.id}):this.myValues.splice((s=t.id,this.myValues.findIndex(function(e){return e.id===s})),1),this.markWillUpdateNode(t),this.walkUp(t,"status"),this.walkDown(t,"status")}},r.prototype.getValues=function(){var e=[];for(var t in this.leafNodesById)this.leafNodesById.hasOwnProperty(t)&&(1!==this.leafNodesById[t].status&&2!==this.leafNodesById[t].status||e.push(t));return e},r.prototype.setValues=function(e){var t=this;this.emptyNodesCheckStatus(),e.forEach(function(e){t.setValue(e)}),this.updateLiElements();var s=this.options.onChange;s&&s.call(this)},r.prototype.setDisable=function(e){var t=this.nodesById[e];t&&(t.disabled||(t.disabled=!0,this.markWillUpdateNode(t),this.walkUp(t,"disabled"),this.walkDown(t,"disabled")))},r.prototype.getDisables=function(){var e=[];for(var t in this.leafNodesById)this.leafNodesById.hasOwnProperty(t)&&this.leafNodesById[t].disabled&&e.push(t);return e},r.prototype.setDisables=function(e){var t=this;this.emptyNodesDisable(),e.forEach(function(e){t.setDisable(e)}),this.updateLiElements()},r.prototype.emptyNodesCheckStatus=function(){this.willUpdateNodesById=this.getSelectedNodesById(),Object.values(this.willUpdateNodesById).forEach(function(e){e.disabled||(e.status=0)})},r.prototype.emptyNodesDisable=function(){this.willUpdateNodesById=this.getDisabledNodesById(),Object.values(this.willUpdateNodesById).forEach(function(e){e.disabled=!1})},r.prototype.getSelectedNodesById=function(){return Object.entries(this.nodesById).reduce(function(e,t){var s=n(t,2),i=s[0],a=s[1];return 1!==a.status&&2!==a.status||(e[i]=a),e},{})},r.prototype.getDisabledNodesById=function(){return Object.entries(this.nodesById).reduce(function(e,t){var s=n(t,2),i=s[0],a=s[1];return a.disabled&&(e[i]=a),e},{})},r.prototype.updateLiElements=function(){var e=this;Object.values(this.willUpdateNodesById).forEach(function(t){e.updateLiElement(t)}),this.willUpdateNodesById={}},r.prototype.markWillUpdateNode=function(e){this.willUpdateNodesById[e.id]=e},r.prototype.onSwitcherClick=function(e){var t=e.parentNode,s=t.lastChild,n=s.scrollHeight;t.classList.contains("treejs-node__close")?a(150,{enter:function(){s.style.height=0,s.style.opacity=0},active:function(){s.style.height="".concat(n,"px"),s.style.opacity=1},leave:function(){s.style.height="",s.style.opacity="",t.classList.remove("treejs-node__close")}}):a(150,{enter:function(){s.style.height="".concat(n,"px"),s.style.opacity=1},active:function(){s.style.height=0,s.style.opacity=0},leave:function(){s.style.height="",s.style.opacity="",t.classList.add("treejs-node__close")}})},r.prototype.walkUp=function(e,t){var s=e.parent;if(s){if("status"===t){var n=null,i=s.children.reduce(function(e,t){return isNaN(t.status)?e:e+t.status},0);if(n=i?i===2*s.children.length?2:1:0,s.status===n)return;s.status=n}else{var a=s.children.reduce(function(e,t){return e&&t.disabled},!0);if(s.disabled===a)return;s.disabled=a}this.markWillUpdateNode(s),this.walkUp(s,t)}},r.prototype.walkDown=function(e,t){var s=this;e.children&&e.children.length&&e.children.forEach(function(n){"status"===t&&n.disabled||(n[t]=e[t],s.markWillUpdateNode(n),s.walkDown(n,t))})},r.prototype.updateLiElement=function(e){var t=this.liElementsById[e.id].classList;switch(e.status){case 0:t.remove("treejs-node__halfchecked","treejs-node__checked");break;case 1:t.remove("treejs-node__checked"),t.add("treejs-node__halfchecked");break;case 2:t.remove("treejs-node__halfchecked"),t.add("treejs-node__checked")}switch(e.disabled){case!0:t.contains("treejs-node__disabled")||t.add("treejs-node__disabled");break;case!1:t.contains("treejs-node__disabled")&&t.remove("treejs-node__disabled")}},r.parseTreeData=function(e){var t,s=(t=e,JSON.parse(JSON.stringify(t))),n={},i={},a=[],r=[];return function e(t,s){t.forEach(function(t){n[t.id]=t,t.checked&&a.push(t.id),t.disabled&&r.push(t.id),s&&(t.parent=s),t.children&&t.children.length?e(t.children,t):i[t.id]=t})}(s),{treeNodes:s,nodesById:n,leafNodesById:i,defaultValues:a,defaultDisables:r}},r.createRootEle=function(){var e=document.createElement("div");return e.classList.add("treejs"),e},r.createUlEle=function(){var e=document.createElement("ul");return e.classList.add("treejs-nodes"),e},r.createLiEle=function(e,t){var s=document.createElement("li");if(s.classList.add("treejs-node"),t&&s.classList.add("treejs-node__close"),e.children&&e.children.length){var n=document.createElement("span");n.classList.add("treejs-switcher"),s.appendChild(n)}else s.classList.add("treejs-placeholder");var i=document.createElement("span");i.classList.add("treejs-checkbox"),i.dataset.id=e.id,i.value=e.name,s.appendChild(i);var a=document.createElement("span");a.classList.add("treejs-label");var r=document.createTextNode(e.name);return a.appendChild(r),s.appendChild(a),s.nodeId=e.id,s}}]).default});
//# sourceMappingURL=tree.min.js.map